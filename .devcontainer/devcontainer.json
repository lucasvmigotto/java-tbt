{
	"name": "java-tbt",
	"build": {
        "dockerfile": "./Dockerfile",
        "context": ".."
    },
	"runArgs": [
        "--rm",
        "--name", "vsc-java-tbt",
        "--env-file", ".env",
        "--network", "java-tbt-network"
    ],
    "workspaceFolder": "/code",
    "remoteUser": "vscode",
    "mounts": [
        {
            "source": "${localWorkspaceFolder}",
            "target": "/code",
            "type": "bind"
        },
        {
            "source": "java-tbt-dependencies",
            "target": "/home/vscode/.m2",
            "type": "volume"

        },
        {
            "source": "/var/run/docker.sock",
            "target": "/var/run/docker.sock",
            "type": "bind"

        },
        {
            "source": "devcontainer-java-tbt-extensions",
            "target": "/root/.vscode-server/extensions",
            "type": "volume"
        }
    ],
	"features": {
        "ghcr.io/devcontainers/features/docker-in-docker:2": {},
		"ghcr.io/devcontainers/features/java:1": {
			"version": "none",
			"installMaven": "false",
			"installGradle": "true"
		}
	},
    "initializeCommand": {
        "docker-volume ": "[ -z $(docker volume ls -qf 'name=java-tbt-postgres-data') ] && docker volume create 'java-tbt-postgres-data' || echo 'Docker volume already exists'",
        "docker-network": "[ -z $(docker network ls -qf 'name=java-tbt-network') ] && docker network create 'java-tbt-network' || echo 'Docker network already exists'",
        ".env": "[ ! -f '.env' ] && (echo 'Creating .env from template' && cp .env.example .env) || echo '.env file found'"
    },
    "updateContentCommand": {
        "docke-remove-config": "rm -r $HOME/.docker/config.json"
    },
    "customizations": {
		"vscode": {
			"settings": {
                "remote.autoForwardPorts": true,
				"java.format.settings.profile": "GoogleStyle",
                "java.format.settings.imports.regexp": "^[a-z.]*",
                "java.checkstyle.configuration": "https://raw.githubusercontent.com/google/styleguide/refs/heads/gh-pages/intellij-java-google-style.xml",
                "java.checkstyle.version": "9.3",
                "java.autobuild.enabled": true,
                "[java]": {
					"editor.formatOnSave": true,
					"editor.defaultFormatter": "redhat.java"
				},
                "editor.codeActionsOnSave": {
                    "source.organizeImports": "explicit"
                },
                "workbench.colorTheme": "Vim Deep Dark",
                "workbench.iconTheme": "vscode-icons"
			},
			"extensions": [
				// Development
                "redhat.java",
                "vscjava.vscode-java-dependency",
                "vscjava.vscode-java-test",
                "vscjava.vscode-java-debug",
                "vscjava.vscode-maven",
                "vscjava.vscode-spring-boot-dashboard",
                "vmware.vscode-spring-boot",
                "Oracle.oracle-java",
                // DevOps
                "GitHub.vscode-github-actions",
                "SanjulaGanepola.github-local-actions",
				// Style and Linting
				"shengchen.vscode-checkstyle",
				"DavidAnson.vscode-markdownlint",
                "xyz.plsql-language",
                "Cardinal90.multi-cursor-case-preserve",
                "DotJoshJohnson.xml",
				"redhat.vscode-yaml",
                "mohsen1.prettify-json",
				// Utils
				"EditorConfig.EditorConfig",
				"mhutchie.git-graph",
				"ryu1kn.partial-diff",
				"njzy.stats-bar",
				"christian-kohler.path-intellisense",
                "humao.rest-client",
				// Miscellaneous
                "HarryHopkinson.vim-theme",
                "vscode-icons-team.vscode-icons",
				"streetsidesoftware.code-spell-checker",
				"streetsidesoftware.code-spell-checker-portuguese-brazilian"
			]
		}
	}
}
